{"ast":null,"code":"import _classCallCheck from\"/Users/nguyentrungchinh/project_14/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/nguyentrungchinh/project_14/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _assertThisInitialized from\"/Users/nguyentrungchinh/project_14/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";import _inherits from\"/Users/nguyentrungchinh/project_14/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/nguyentrungchinh/project_14/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import'./App.css';import axios from'axios';// import React, { Component } from 'react';\nimport React from'react';import{inference}from'./inference.js';import{columnNames}from'./inference.js';import{modelDownloadInProgress}from'./inference.js';import Chart from\"react-google-charts\";import Box from'@mui/material/Box';import LinearProgress from'@mui/material/LinearProgress';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var TextInputArea=/*#__PURE__*/function(_React$Component){_inherits(TextInputArea,_React$Component);var _super=_createSuper(TextInputArea);function TextInputArea(props){var _this;_classCallCheck(this,TextInputArea);_this=_super.call(this,props);_this.state={// Initially, no file is selected\nselectedFile:null};_this.onFileChange=function(event){// Update the state\n_this.setState({selectedFile:event.target.files[0]});};_this.onFileUpload=function(){// Create an object of formData\nvar formData=new FormData();// Update the formData object\nformData.append(\"myFile\",_this.state.selectedFile,_this.state.selectedFile.name);// Details of the uploaded file\nconsole.log(_this.state.selectedFile);// Request made to the backend api\n// Send formData object\naxios.post(\"api/uploadfile\",formData);};_this.fileData=function(){if(_this.state.selectedFile){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"File Details:\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"File Name: \",_this.state.selectedFile.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"File Type: \",_this.state.selectedFile.type]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Last Modified:\",\" \",_this.state.selectedFile.lastModifiedDate.toDateString()]})]});}else{return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"h4\",{children:\"Choose before Pressing the Upload button\"})]});}};_this.state={text:'Enter text to classify emotion, model trained on English text.',data:columnNames,latency:0.0,downloading:modelDownloadInProgress()};_this.handleChange=_this.handleChange.bind(_assertThisInitialized(_this));return _this;}_createClass(TextInputArea,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.timerID=setInterval(function(){return _this2.checkModelStatus();},1000);}},{key:\"checkModelStatus\",value:function checkModelStatus(){var _this3=this;this.setState({downloading:modelDownloadInProgress()});if(!this.state.downloading){this.timerID=setInterval(function(){return _this3.checkModelStatus;},5000000);}}},{key:\"handleChange\",value:function handleChange(event){var _this4=this;inference(event.target.value).then(function(result){_this4.setState({text:event.target.value,data:result[1],latency:result[0]});});}},{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"GeeksforGeeks\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"File Upload using React!\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:this.onFileChange}),/*#__PURE__*/_jsx(\"button\",{onClick:this.onFileUpload,children:\"Upload!\"})]}),this.fileData()]});}}]);return TextInputArea;}(React.Component);export default TextInputArea;","map":{"version":3,"names":["axios","React","inference","columnNames","modelDownloadInProgress","Chart","Box","LinearProgress","TextInputArea","props","state","selectedFile","onFileChange","event","setState","target","files","onFileUpload","formData","FormData","append","name","console","log","post","fileData","type","lastModifiedDate","toDateString","text","data","latency","downloading","handleChange","bind","timerID","setInterval","checkModelStatus","value","then","result","Component"],"sources":["/Users/nguyentrungchinh/project_14/src/App.js"],"sourcesContent":["import './App.css';\n\nimport axios from 'axios';\n// import React, { Component } from 'react';\n\nimport React from 'react';\nimport {inference} from './inference.js';\nimport {columnNames} from './inference.js';\nimport {modelDownloadInProgress} from './inference.js';\nimport Chart from \"react-google-charts\";\nimport Box from '@mui/material/Box';\nimport LinearProgress from '@mui/material/LinearProgress';\n\n \n\nclass TextInputArea extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      text: 'Enter text to classify emotion, model trained on English text.',\n      data:columnNames,\n      latency:0.0,\n      downloading:modelDownloadInProgress()\n    };\n    this.handleChange = this.handleChange.bind(this);\n  }\n\n  componentDidMount() {\n    this.timerID = setInterval(\n      () => this.checkModelStatus(),\n      1000\n    );\n  }\n\n  checkModelStatus() {\n    this.setState({\n      downloading: modelDownloadInProgress(),\n    });\n    if (!this.state.downloading) {\n      this.timerID = setInterval(\n        () => this.checkModelStatus,\n        5000000\n      );\n    }\n  }\n\n  handleChange(event) {  \n    inference(event.target.value).then( result => {\n      this.setState({\n        text : event.target.value,\n        data:result[1],\n        latency:result[0],\n      });\n    });\n  }\n\n  render() {\n    return (\n      <div className=\"App\">\n      <header className=\"App-header\">   \n      <em>In-Browser Transformer Inference</em>\n      <Chart  \n        width={'400px'}\n        height={'200px'}\n        chartType=\"BarChart\"\n        data={this.state.data}\n        options={{\n          chartArea: { width: '40%'},\n          colors: ['purple'],\n          backgroundColor: '#282c34',\n          legend: { \n            textStyle: {color: 'white', fontSize: 10},\n            labels: {fontColor:'white'}\n          },\n          vAxis: {\n            textStyle: {\n            color: 'white',\n            fontSize: 13\n          }\n          },\n          hAxis: {\n            minValue: 5,\n            maxValue: 50,\n            textStyle: {\n              color: 'white'\n            }\n          }\n      }}\n      />  \n      \n      {this.state.downloading && \n        <div><font size=\"2\">Downloading model from CDN to browser..</font>\n        <Box sx={{ width: '400px' }}>\n        <LinearProgress />\n        </Box> \n        <p></p>\n        </div>\n      }\n      <textarea rows=\"8\" cols=\"24\" className=\"App-textarea\" name=\"message\" \n       placeholder={this.state.text} autoFocus onChange={this.handleChange}>\n      </textarea>\n       <div><font size=\"3\">Inference Latency {this.state.latency} ms</font></div>\n      <div><font size=\"3\">GitHub Repo: <a href=\"https://github.com/jobergum/browser-ml-inference\">browser-ml-inference</a></font></div>\n      <div><font size=\"3\">Model was trained on the <a href=\"https://ai.googleblog.com/2021/10/goemotions-dataset-for-fine-grained.html\">GoEmotions</a> dataset.</font></div>\n      </header>\n    </div>   \n    );\n  }\n\n\n\n\n  state = {\n \n    // Initially, no file is selected\n    selectedFile: null\n  };\n\n  // On file select (from the pop up)\n  onFileChange = event => {\n\n      // Update the state\n      this.setState({ selectedFile: event.target.files[0] });\n\n  };\n\n  // On file upload (click the upload button)\n  onFileUpload = () => {\n\n      // Create an object of formData\n      const formData = new FormData();\n\n      // Update the formData object\n      formData.append(\n          \"myFile\",\n          this.state.selectedFile,\n          this.state.selectedFile.name\n      );\n\n      // Details of the uploaded file\n      console.log(this.state.selectedFile);\n\n      // Request made to the backend api\n      // Send formData object\n      axios.post(\"api/uploadfile\", formData);\n  };\n\n  // File content to be displayed after\n  // file upload is complete\n  fileData = () => {\n\n      if (this.state.selectedFile) {\n\n          return (\n              <div>\n                  <h2>File Details:</h2>\n                  <p>File Name: {this.state.selectedFile.name}</p>\n\n                  <p>File Type: {this.state.selectedFile.type}</p>\n\n                  <p>\n                      Last Modified:{\" \"}\n                      {this.state.selectedFile.lastModifiedDate.toDateString()}\n                  </p>\n\n              </div>\n          );\n      } else {\n          return (\n              <div>\n                  <br />\n                  <h4>Choose before Pressing the Upload button</h4>\n              </div>\n          );\n      }\n  };\n\n  render() {\n\n      return (\n          <div>\n              <h1>\n                  GeeksforGeeks\n              </h1>\n              <h3>\n                  File Upload using React!\n              </h3>\n              <div>\n                  <input type=\"file\" onChange={this.onFileChange} />\n                  <button onClick={this.onFileUpload}>\n                      Upload!\n                  </button>\n              </div>\n              {this.fileData()}\n          </div>\n      );\n  } \n\n\n\n}\nexport default TextInputArea;\n\n\n \n"],"mappings":"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"},"metadata":{},"sourceType":"module"}